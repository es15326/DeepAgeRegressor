
<!-- Banner -->
<p align="center">
  <img src="banner.png" alt="DeepAgeRegressor Banner" width="100%">
</p>

<h1 align="center">🧬 DeepAgeRegressor</h1>

<p align="center">
  <strong>Deep Learning for Human Age Estimation from Facial Images</strong><br>
  <em>Modular • Scalable • Research-Ready</em><br>
  <sub>Optimized for AI research, fairness studies, and real-world applications.</sub>
</p>

---

## 🚀 Overview

**DeepAgeRegressor** is a flexible and high-performance framework for **facial age prediction using direct regression**. Built on top of PyTorch, it supports multiple state-of-the-art backbones like **ResNeXt** and **Vision Transformers**, with full YAML configuration, custom loss functions, and support for LLM-generated synthetic datasets.

> 🎯 Designed for fast experimentation and scientific rigor, making it ideal for academic research, fair-AI benchmarking, and applied computer vision studies.

---

## 🧠 Supported Models

| Model          | Architecture         | Output       | Loss Functions                 |
|----------------|----------------------|--------------|--------------------------------|
| `ResNetAgeModel` | ResNet-50            | Continuous   | MSE, Weighted MSE              |
| `ResNext`        | ResNeXt-50 (32x4d)   | Continuous   | Soft-AAR, Weighted MSE         |
| `ViTAgeModel`    | ViT-B/16 Transformer | Continuous   | MSE                            |

---

## 🧾 Project Structure

```bash
deepage-regressor/
├── config/           # YAML configs for training
├── data/             # Dataset preprocessing
├── nets/             # Models: ResNet, ResNeXt, ViT
├── loss/             # Custom loss implementations
├── trainer/          # Training loop and scheduler
├── train.py          # CLI training entry point
├── eval.py           # Evaluation/inference script
└── README.md
```

---

## ⚙️ Installation

```bash
pip install -r requirements.txt
```

---

## 🧃 Dataset Format

CSV structure:

```csv
image_path,age
images/img_001.jpg,23
images/img_002.jpg,45
```

Supports:
- ✅ UTKFace (out of the box)
- ✅ FG-NET (with preprocessing)
- ✅ Custom datasets in same format

---

## 🧪 Training

```bash
python train.py --config config/resnet.yaml
```

Configurable options: model type, learning rate, batch size, optimizer, epochs, and loss function.

---

## 📊 Evaluation

```bash
python eval.py \
  --model_name ResNext \
  --checkpoint_path checkpoints/WAAR-epoch=047.ckpt \
  --test_csv data/test.csv \
  --img_path data/images \
  --batch_size 64 \
  --num_workers 4
```

---

## 📈 Results (Real-World Benchmarks)

| Model        | MAE ↓ | Highlights                            |
|--------------|-------|----------------------------------------|
| ResNet-50    | 1.36  | Baseline using MSE                    |
| ViT-B/16     | 1.28  | Transformer-based, slight boost       |
| ResNeXt-50   | **0.74**  | Best: Augmentation + Soft-AAR loss     |

> ✅ **Lowest MAE** achieved using ResNeXt-50 with **LLM-assisted synthetic augmentation**.

---

## 🧮 Custom Loss Functions

- **MSE**: Standard Mean Squared Error  
- **Weighted MSE**: Increases penalty on underrepresented age ranges  
- **Soft-AAR**: Age-Aware Reliability loss that balances accuracy and uncertainty

---

## 🧪 Synthetic Data Generation (LLM + Diffusion)

To improve model robustness on **low-sample age groups (1–5 years)**, we used **LLM-guided Stable Diffusion** to generate synthetic facial images, based on prompts generated by ChatGPT.

### 📸 Synthetic Highlights
- **13,558** high-quality synthetic samples
- Representing diverse ethnicity, expressions, and lighting
- Generated with *Stable Diffusion v1.5* + *LLM prompt design*

### 📉 Performance Boost

| Model        | Dataset             | Age Group | MAE ↓ | Notes                              |
|--------------|---------------------|-----------|-------|-------------------------------------|
| ResNeXt-50   | Real Only           | 1–5       | 2.14  | High error on low-sample group     |
| ResNeXt-50   | + LLM Synthetic     | 1–5       | 1.06  | 50% error reduction                 |
| ViT-B/16     | + LLM Synthetic     | 1–5       | 1.22  | Improved generalization            |

> 🚀 *Synthetic augmentation dramatically boosts performance for young age prediction.*

---

## 🧰 Sample YAML Configuration

```yaml
model:
  name: resnext
  pretrained: true

training:
  batch_size: 64
  epochs: 100
  lr: 0.0001

loss:
  type: weighted_mse
```

---

## 🎯 Project Goals

- 🔬 Promote reproducible facial age estimation research
- 🧪 Encourage exploration of synthetic data techniques
- 🧱 Provide a clean, extendable PyTorch baseline
- 👩‍💻 Built for researchers, interns, and students

---

## 📄 License

Released under the MIT License. See `LICENSE` for details.

---

<p align="center">
  Made with 💙 for trustworthy, impactful AI research.
</p>
