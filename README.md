
<!-- Banner -->
<p align="center">
  <img src="banner.png" alt="DeepAgeRegressor Banner" width="100%">
</p>

<h1 align="center">ğŸ§¬ DeepAgeRegressor</h1>

<p align="center">
  <strong>Deep Learning for Human Age Estimation from Facial Images</strong><br>
  <em>Modular â€¢ Scalable â€¢ Research-Ready</em><br>
  <sub>Optimized for AI research, fairness studies, and real-world applications.</sub>
</p>

---

## ğŸš€ Overview

**DeepAgeRegressor** is a flexible and high-performance framework for **facial age prediction using direct regression**. Built on top of PyTorch, it supports multiple state-of-the-art backbones like **ResNeXt** and **Vision Transformers**, with full YAML configuration, custom loss functions, and support for LLM-generated synthetic datasets.

> ğŸ¯ Designed for fast experimentation and scientific rigor, making it ideal for academic research, fair-AI benchmarking, and applied computer vision studies.

---

## ğŸ§  Supported Models

| Model          | Architecture         | Output       | Loss Functions                 |
|----------------|----------------------|--------------|--------------------------------|
| `ResNetAgeModel` | ResNet-50            | Continuous   | MSE, Weighted MSE              |
| `ResNext`        | ResNeXt-50 (32x4d)   | Continuous   | Soft-AAR, Weighted MSE         |
| `ViTAgeModel`    | ViT-B/16 Transformer | Continuous   | MSE                            |

---

## ğŸ§¾ Project Structure

```bash
deepage-regressor/
â”œâ”€â”€ config/           # YAML configs for training
â”œâ”€â”€ data/             # Dataset preprocessing
â”œâ”€â”€ nets/             # Models: ResNet, ResNeXt, ViT
â”œâ”€â”€ loss/             # Custom loss implementations
â”œâ”€â”€ trainer/          # Training loop and scheduler
â”œâ”€â”€ train.py          # CLI training entry point
â”œâ”€â”€ eval.py           # Evaluation/inference script
â””â”€â”€ README.md
```

---

## âš™ï¸ Installation

```bash
pip install -r requirements.txt
```

---

## ğŸ§ƒ Dataset Format

CSV structure:

```csv
image_path,age
images/img_001.jpg,23
images/img_002.jpg,45
```

Supports:
- âœ… UTKFace (out of the box)
- âœ… FG-NET (with preprocessing)
- âœ… Custom datasets in same format

---

## ğŸ§ª Training

```bash
python train.py --config config/resnet.yaml
```

Configurable options: model type, learning rate, batch size, optimizer, epochs, and loss function.

---

## ğŸ“Š Evaluation

```bash
python eval.py \
  --model_name ResNext \
  --checkpoint_path checkpoints/WAAR-epoch=047.ckpt \
  --test_csv data/test.csv \
  --img_path data/images \
  --batch_size 64 \
  --num_workers 4
```

---

## ğŸ“ˆ Results (Real-World Benchmarks)

| Model        | MAE â†“ | Highlights                            |
|--------------|-------|----------------------------------------|
| ResNet-50    | 1.36  | Baseline using MSE                    |
| ViT-B/16     | 1.28  | Transformer-based, slight boost       |
| ResNeXt-50   | **0.74**  | Best: Augmentation + Soft-AAR loss     |

> âœ… **Lowest MAE** achieved using ResNeXt-50 with **LLM-assisted synthetic augmentation**.

---

## ğŸ§® Custom Loss Functions

- **MSE**: Standard Mean Squared Error  
- **Weighted MSE**: Increases penalty on underrepresented age ranges  
- **Soft-AAR**: Age-Aware Reliability loss that balances accuracy and uncertainty

---

## ğŸ§ª Synthetic Data Generation (LLM + Diffusion)

To improve model robustness on **low-sample age groups (1â€“5 years)**, we used **LLM-guided Stable Diffusion** to generate synthetic facial images, based on prompts generated by ChatGPT.

### ğŸ“¸ Synthetic Highlights
- **13,558** high-quality synthetic samples
- Representing diverse ethnicity, expressions, and lighting
- Generated with *Stable Diffusion v1.5* + *LLM prompt design*

### ğŸ“‰ Performance Boost

| Model        | Dataset             | Age Group | MAE â†“ | Notes                              |
|--------------|---------------------|-----------|-------|-------------------------------------|
| ResNeXt-50   | Real Only           | 1â€“5       | 2.14  | High error on low-sample group     |
| ResNeXt-50   | + LLM Synthetic     | 1â€“5       | 1.06  | 50% error reduction                 |
| ViT-B/16     | + LLM Synthetic     | 1â€“5       | 1.22  | Improved generalization            |

> ğŸš€ *Synthetic augmentation dramatically boosts performance for young age prediction.*

---

## ğŸ§° Sample YAML Configuration

```yaml
model:
  name: resnext
  pretrained: true

training:
  batch_size: 64
  epochs: 100
  lr: 0.0001

loss:
  type: weighted_mse
```

---

## ğŸ¯ Project Goals

- ğŸ”¬ Promote reproducible facial age estimation research
- ğŸ§ª Encourage exploration of synthetic data techniques
- ğŸ§± Provide a clean, extendable PyTorch baseline
- ğŸ‘©â€ğŸ’» Built for researchers, interns, and students

---

## ğŸ“„ License

Released under the MIT License. See `LICENSE` for details.

---

<p align="center">
  Made with ğŸ’™ for trustworthy, impactful AI research.
</p>
